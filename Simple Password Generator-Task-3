import string
import random
import tkinter as TK
from tkinter import messagebox

def GENERATE_AND_DISPLAY_SECRET():
    try:
        SECRET_LENGTH = GET_SECRET_LENGTH_FROM_INPUT()
        VALID_CHARACTERS = string.ascii_letters + string.digits + string.punctuation
        SECRET_KEY = GENERATE_SECRET_KEY(SECRET_LENGTH, VALID_CHARACTERS)
        DISPLAY_SECRET_KEY(SECRET_KEY)
    except ValueError:
        SHOW_ERROR_ALERT("Error", "Invalid input. Please provide a positive integer.")

def GET_SECRET_LENGTH_FROM_INPUT():
    LENGTH_STR = SECRET_LENGTH_ENTRY.get()
    SECRET_LENGTH = int(LENGTH_STR)
    if SECRET_LENGTH <= 0:
        raise ValueError("Length must be a positive integer")
    return SECRET_LENGTH

def GENERATE_SECRET_KEY(LENGTH, CHARACTERS):
    return ''.join(random.choice(CHARACTERS) for _ in range(LENGTH))

def DISPLAY_SECRET_KEY(KEY):
    SECRET_KEY_OUTPUT.config(state='normal')
    SECRET_KEY_OUTPUT.delete(1.0, TK.END)
    SECRET_KEY_OUTPUT.insert(TK.END, KEY)
    SECRET_KEY_OUTPUT.config(state='disabled')

def SHOW_ERROR_ALERT(TITLE, MESSAGE):
    messagebox.showerror(TITLE, MESSAGE)


CONFIDENTIAL_ROOT = TK.Tk()
CONFIDENTIAL_ROOT.title("Top-Secret Key Generator")

CONFIDENTIAL_FRAME = TK.Frame(CONFIDENTIAL_ROOT, padx=20, pady=20)
CONFIDENTIAL_FRAME.pack()

SECRET_LENGTH_LABEL = TK.Label(CONFIDENTIAL_FRAME, text="Enter Key Length:")
SECRET_LENGTH_LABEL.grid(row=0, column=0, padx=10, pady=5)

SECRET_LENGTH_ENTRY = TK.Entry(CONFIDENTIAL_FRAME)
SECRET_LENGTH_ENTRY.grid(row=0, column=1, padx=10, pady=5)

GENERATE_SECRET_BUTTON = TK.Button(CONFIDENTIAL_FRAME, text="Generate Top-Secret Key", command=GENERATE_AND_DISPLAY_SECRET)
GENERATE_SECRET_BUTTON.grid(row=1, columnspan=2, padx=10, pady=10)

SECRET_KEY_OUTPUT = TK.Text(CONFIDENTIAL_FRAME, height=5, width=30)
SECRET_KEY_OUTPUT.grid(row=2, columnspan=2, padx=10, pady=5)
SECRET_KEY_OUTPUT.config(state='disabled')

CONFIDENTIAL_ROOT.mainloop()
